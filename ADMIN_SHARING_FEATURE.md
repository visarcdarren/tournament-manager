# Admin Sharing Feature Implementation\n\n## Overview\n\nThe admin sharing feature allows tournament administrators to share full admin access with other users via secure password-protected links.\n\n## How It Works\n\n### 1. **Current System Structure**\n- **Original Admin**: The user who created the tournament (`adminDeviceId`)\n- **Shared Admins**: Users granted admin access via share links (`devices[]` array with role: 'ADMIN')\n- **Multiple Admins**: All admins have identical permissions (setup, scoring, device management)\n\n### 2. **Admin Sharing Process**\n\n**Creating a Share Link:**\n1. Admin goes to Setup â†’ Admin Access section\n2. Creates a password (minimum 4 characters)\n3. System generates a share link: `/admin-join/{tournamentId}`\n4. Admin shares both link and password with trusted users\n\n**Joining via Share Link:**\n1. User visits the share link\n2. Enters the admin password\n3. System verifies password and grants admin access\n4. User is redirected to tournament with full admin rights\n\n### 3. **Security Features**\n- Passwords are hashed with SHA-256\n- Brute force protection (1-second delay on failed attempts)\n- Share links can be revoked by any admin\n- Original admin cannot have their access revoked\n- Audit logging for all admin sharing activities\n\n## Code Changes Made\n\n### Backend (server.js)\n\n**New Endpoints:**\n```javascript\nPOST /api/tournament/:id/share-admin          // Create share link with password\nPOST /api/tournament/:id/join-admin           // Join as admin using password\nPOST /api/tournament/:id/revoke-admin-share   // Disable admin sharing\nGET  /api/tournament/:id/admin-share-status   // Check sharing status\n```\n\n**Updated Authentication:**\n- `authenticateAdmin()` now checks both `adminDeviceId` and `devices[]` array\n- Supports multiple admins with identical permissions\n- Original admin protection (cannot be revoked)\n\n**Tournament Structure:**\n```javascript\n{\n  adminDeviceId: \"original-admin-device-id\",\n  adminSharePassword: \"hashed-password\", // Optional\n  devices: [\n    {\n      id: \"device-id\",\n      name: \"Device Name\",\n      role: \"ADMIN\" | \"SCORER\" | \"VIEWER\"\n    }\n  ]\n}\n```\n\n### Frontend Components\n\n**AdminSharingDialog.jsx:**\n- Password creation and validation\n- Share link generation and display\n- Status management (enabled/disabled)\n- Copy-to-clipboard functionality\n- Visual feedback for shared vs original admins\n\n**AdminJoinPage.jsx:**\n- Dedicated page for joining via share links\n- Password entry with show/hide toggle\n- Error handling and user feedback\n- Automatic redirect after successful join\n\n**Updated Components:**\n- `TournamentSetup.jsx`: Added admin sharing section\n- `TournamentView.jsx`: Updated role checking and navigation\n- `DevicePermissions.jsx`: Device management interface\n- `App.jsx`: Added `/admin-join/:id` route\n\n## Usage Examples\n\n### Creating Admin Share Link\n```javascript\n// Admin creates share link\nconst response = await api.shareAdmin(tournamentId, \"mypassword123\")\n// Returns: { shareLink: \"https://domain.com/admin-join/tournament-id\", password: \"mypassword123\" }\n```\n\n### Joining as Admin\n```javascript\n// User joins via share link\nconst response = await api.joinAsAdmin(tournamentId, \"mypassword123\")\n// User is now added to devices[] array with role: 'ADMIN'\n```\n\n### Tournament Access Logic\n```javascript\n// Updated access checking\nconst isOriginalAdmin = tournament.adminDeviceId === deviceId\nconst hasAdminAccess = tournament.devices?.some(d => d.id === deviceId && d.role === 'ADMIN')\nconst isAdmin = isOriginalAdmin || hasAdminAccess\n```\n\n## Benefits\n\n1. **Multi-Device Admin Support**: Run tournaments from multiple devices\n2. **Shared Control**: Multiple people can manage the tournament\n3. **Secure Access**: Password-protected with ability to revoke\n4. **Audit Trail**: All admin actions are logged\n5. **Backwards Compatible**: Existing tournaments continue to work\n6. **Clean UI**: Clear distinction between original and shared admins\n\n## Security Considerations\n\n- Share passwords only with trusted individuals\n- Revoke sharing when no longer needed\n- Only original admin can manage device permissions\n- All admin actions are audited\n- Passwords are never stored in plain text\n\nThe feature maintains the simplicity of the existing system while adding powerful collaboration capabilities for tournament management.\n